carbon shake spectra fullerenes single walled carbon nanotubes swcnts investigated equivalent core hole kohn sham density functional theory approach electron transition molecular orbitals core hole potential considered calculated spectra agreement equivalent core hole time dependent density functional theory calculations experiments reliable assignments complicated shake spectra systems provided calculations performed endohedral metallofullerene gd demonstrate shake processes identify charge transfer metal ion carbon cage exciton binding energy systems investigation ev 